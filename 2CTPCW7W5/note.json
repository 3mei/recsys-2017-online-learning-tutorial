{
  "paragraphs": [
    {
      "text": "%md\n\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://github.com/rpalovics/recsys-2017-online-learning-tutorial/blob/master/figs/batch.png?raw\u003dtrue\" width\u003d768 alt\u003d\"time-aware batch\"/\u003e\n\u003c/p\u003e",
      "user": "anonymous",
      "dateUpdated": "Aug 26, 2017 12:18:46 AM",
      "config": {
        "colWidth": 6.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 441.0,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://github.com/rpalovics/recsys-2017-online-learning-tutorial/blob/master/figs/batch.png?raw\u003dtrue\" width\u003d768 alt\u003d\"time-aware batch\"/\u003e\n\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503696541121_368202089",
      "id": "20170825-232901_1378667887",
      "dateCreated": "Aug 25, 2017 11:29:01 PM",
      "dateStarted": "Aug 26, 2017 12:18:46 AM",
      "dateFinished": "Aug 26, 2017 12:18:46 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://github.com/rpalovics/recsys-2017-online-learning-tutorial/blob/master/figs/mf.png?raw\u003dtrue\" alt\u003d\"mf\"/\u003e\n\u003c/p\u003e",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:42:20 PM",
      "config": {
        "colWidth": 6.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 373.0,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://github.com/rpalovics/recsys-2017-online-learning-tutorial/blob/master/figs/mf.png?raw\u003dtrue\" alt\u003d\"mf\"/\u003e\n\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503697309960_235563886",
      "id": "20170825-234149_1906417647",
      "dateCreated": "Aug 25, 2017 11:41:49 PM",
      "dateStarted": "Aug 25, 2017 11:42:07 PM",
      "dateFinished": "Aug 25, 2017 11:42:07 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Alpenglow",
      "text": "%md\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://github.com/rpalovics/Alpenglow/blob/master/misc/alpenglow.png?raw\u003dtrue\" width\u003d400 alt\u003d\"alpenglow\"/\u003e\n\u003c/p\u003e",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:27:49 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://github.com/rpalovics/Alpenglow/blob/master/misc/alpenglow.png?raw\u003dtrue\" width\u003d400 alt\u003d\"alpenglow\"/\u003e\n\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503696140017_1964390646",
      "id": "20170825-232220_1564867282",
      "dateCreated": "Aug 25, 2017 11:22:20 PM",
      "dateStarted": "Aug 25, 2017 11:27:49 PM",
      "dateFinished": "Aug 25, 2017 11:27:49 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Flink",
      "text": "%md\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://flink.apache.org/img/logo/png/1000/flink_squirrel_1000.png\"  width\u003d90 alt\u003d\"alpenglow\"/\u003e\n\u003c/p\u003e",
      "user": "anonymous",
      "dateUpdated": "Aug 26, 2017 12:18:51 AM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "title": true,
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://flink.apache.org/img/logo/png/1000/flink_squirrel_1000.png\"  width\u003d90 alt\u003d\"alpenglow\"/\u003e\n\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503696147689_-999714880",
      "id": "20170825-232227_1562535417",
      "dateCreated": "Aug 25, 2017 11:22:27 PM",
      "dateStarted": "Aug 26, 2017 12:18:51 AM",
      "dateFinished": "Aug 26, 2017 12:18:51 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Spark",
      "text": "%md\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://spark.apache.org/images/spark-logo-trademark.png\" width\u003d170 alt\u003d\"alpenglow\"/\u003e\n\u003c/p\u003e",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:28:31 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp align\u003d\"center\"\u003e\n  \u003cimg src\u003d\"https://spark.apache.org/images/spark-logo-trademark.png\" width\u003d170 alt\u003d\"alpenglow\"/\u003e\n\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503696149644_-175967485",
      "id": "20170825-232229_1489721128",
      "dateCreated": "Aug 25, 2017 11:22:29 PM",
      "dateStarted": "Aug 25, 2017 11:28:31 PM",
      "dateFinished": "Aug 25, 2017 11:28:31 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%python\nimport pandas as pd\nimport numpy as np\nimport heapq\nimport glob\nimport os\nimport shutil\nimport math\nfrom collections import defaultdict\nimport pyarrow.parquet as pq\nimport alpenglow as ag\nfrom alpenglow.offline.models import FactorModel\nfrom alpenglow.offline.evaluation import NdcgScore",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:21:18 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1503043976596_1345513851",
      "id": "20170818-101256_1862447283",
      "dateCreated": "Aug 18, 2017 10:12:56 AM",
      "dateStarted": "Aug 25, 2017 11:21:18 PM",
      "dateFinished": "Aug 25, 2017 11:21:18 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\r\nimport hu.sztaki.ilab.ps.matrix.factorization.Utils._\r\nimport hu.sztaki.ilab.ps.matrix.factorization.data.parsers._\r\nimport hu.sztaki.ilab.ps.matrix.factorization.PSOfflineMatrixFactorization._\r\nimport hu.sztaki.ilab.ps.matrix.factorization.sinks._\r\nimport hu.sztaki.ilab.ps.matrix.factorization.PSTopKGeneratorWithLEMPForTutorial._\r\n\r\nsenv.setParallelism(4)",
      "user": "anonymous",
      "dateUpdated": "Aug 26, 2017 12:44:13 AM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import hu.sztaki.ilab.ps.matrix.factorization.Utils._\nimport hu.sztaki.ilab.ps.matrix.factorization.data.parsers._\nimport hu.sztaki.ilab.ps.matrix.factorization.PSOfflineMatrixFactorization._\nimport hu.sztaki.ilab.ps.matrix.factorization.sinks._\nimport hu.sztaki.ilab.ps.matrix.factorization.PSTopKGeneratorWithLEMPForTutorial._\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503043992138_-1755346101",
      "id": "20170818-101312_1674360328",
      "dateCreated": "Aug 18, 2017 10:13:12 AM",
      "dateStarted": "Aug 26, 2017 12:44:13 AM",
      "dateFinished": "Aug 26, 2017 12:44:15 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nfrom pyspark.mllib.recommendation import ALS, MatrixFactorizationModel, Rating\nimport pandas as pd\nimport os\nimport shutil\nimport heapq\nimport math\nfrom collections import defaultdict\nimport pyarrow.parquet as pq",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:33:29 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "pyspark is not responding"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044018011_1384250897",
      "id": "20170818-101338_623641606",
      "dateCreated": "Aug 18, 2017 10:13:38 AM",
      "dateStarted": "Aug 25, 2017 11:33:29 PM",
      "dateFinished": "Aug 25, 2017 11:33:39 PM",
      "status": "ERROR",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "reading data",
      "text": "%md\n## Reading the data",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:22:08 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "title": false,
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eReading the data\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044468987_248899576",
      "id": "20170818-102108_1984320246",
      "dateCreated": "Aug 18, 2017 10:21:08 AM",
      "dateStarted": "Aug 25, 2017 11:22:08 PM",
      "dateFinished": "Aug 25, 2017 11:22:08 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "train_batch \u003d pd.read_csv(\n    \u0027train_batch\u0027,\n    header\u003dNone,\n    names\u003d[\u0027time\u0027,\u0027user\u0027,\u0027item\u0027]\n)",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 6:10:52 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1503044042861_-1196062407",
      "id": "20170818-101402_497732565",
      "dateCreated": "Aug 18, 2017 10:14:02 AM",
      "dateStarted": "Aug 22, 2017 6:10:52 PM",
      "dateFinished": "Aug 22, 2017 6:10:52 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\nval trainDataPath \u003d \"train_batch\"\nval testDataPath \u003d \"test_batch\"\nval model \u003d \"model\"\nval topKOut \u003d \"topK.out\"\n\nval trainData \u003d ImplicitDataToRatingParser.parse(senv,trainDataPath,\",\",1,2)",
      "user": "anonymous",
      "dateUpdated": "Aug 26, 2017 12:44:33 AM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "trainDataPath: String \u003d train_batch\ntestDataPath: String \u003d test_batch\nmodel: String \u003d model\ntopKOut: String \u003d topK.out\ntrainData: hu.sztaki.ilab.ps.utils.DataStreamWithNameableFunctions[hu.sztaki.ilab.ps.matrix.factorization.Utils.Rating] \u003d hu.sztaki.ilab.ps.utils.DataStreamWithNameableFunctions@4cf55f28\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044083369_929721239",
      "id": "20170818-101443_42483437",
      "dateCreated": "Aug 18, 2017 10:14:43 AM",
      "dateStarted": "Aug 26, 2017 12:44:33 AM",
      "dateFinished": "Aug 26, 2017 12:44:35 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\ntrain \u003d sc.textFile(\"train_batch\").map(lambda l: l.split(\u0027,\u0027))\\\n    .map(lambda l: Rating(int(l[1]), int(l[2]), 1.0))\n",
      "user": "anonymous",
      "dateUpdated": "Aug 25, 2017 11:33:55 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1503044383850_-1498583956",
      "id": "20170818-101943_1275364393",
      "dateCreated": "Aug 18, 2017 10:19:43 AM",
      "dateStarted": "Aug 22, 2017 4:54:17 PM",
      "dateFinished": "Aug 22, 2017 4:54:42 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "training models",
      "text": "%md\n## Training models",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 5:13:03 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "title": false,
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eTraining models\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044296819_857543332",
      "id": "20170818-101816_1155782585",
      "dateCreated": "Aug 18, 2017 10:18:16 AM",
      "dateStarted": "Aug 22, 2017 5:12:57 PM",
      "dateFinished": "Aug 22, 2017 5:12:57 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "model \u003d FactorModel(\n    dimension\u003d20,\n    learning_rate\u003d0.05,\n    negative_rate\u003d9,\n    number_of_iterations\u003d4,\n)\nmodel.fit(train_batch)",
      "user": "anonymous",
      "dateUpdated": "Aug 21, 2017 1:23:18 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Beginning of \n1th iteration.\n\n\nEnd of 1th iteration.\nBeginning of 2th iteration.\n\n\nEnd of 2th iteration.\nBeginning of 3th iteration.\n\n\nEnd of 3th iteration.\nBeginning of 4th iteration.\n\nEnd of 4th iteration.\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044488882_-1534781001",
      "id": "20170818-102128_494115451",
      "dateCreated": "Aug 18, 2017 10:21:28 AM",
      "dateStarted": "Aug 21, 2017 1:23:18 PM",
      "dateFinished": "Aug 21, 2017 1:24:27 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\npsOfflineMF(\n        trainData,\n        learningRate \u003d 0.05,\n        negativeSampleRate \u003d 9,\n        iterations \u003d 4)\n    .addSink(new VectorModelToFileSink(model))\n    .setParallelism(1)\n\nsenv.execute()",
      "user": "anonymous",
      "dateUpdated": "Aug 26, 2017 12:45:17 AM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res39: org.apache.flink.streaming.api.datastream.DataStreamSink[Either[(hu.sztaki.ilab.ps.matrix.factorization.Utils.UserId, hu.sztaki.ilab.ps.matrix.factorization.Vector.Vector),(hu.sztaki.ilab.ps.matrix.factorization.Utils.ItemId, hu.sztaki.ilab.ps.matrix.factorization.Vector.Vector)]] \u003d org.apache.flink.streaming.api.datastream.DataStreamSink@28d87c6b\nres40: org.apache.flink.api.common.JobExecutionResult \u003d org.apache.flink.api.common.JobExecutionResult@27e0eb15\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044504674_-241408440",
      "id": "20170818-102144_2001725201",
      "dateCreated": "Aug 18, 2017 10:21:44 AM",
      "dateStarted": "Aug 26, 2017 12:45:17 AM",
      "dateFinished": "Aug 26, 2017 12:48:25 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nrank \u003d 20\nnumIter \u003d 8\nreg \u003d 0.01\nalpha \u003d 40\n\nmodel \u003d ALS.trainImplicit(train, rank, numIter, reg, alpha)\n",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 4:54:19 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1503044524622_-469549214",
      "id": "20170818-102204_1132678300",
      "dateCreated": "Aug 18, 2017 10:22:04 AM",
      "dateStarted": "Aug 22, 2017 4:54:41 PM",
      "dateFinished": "Aug 22, 2017 4:55:16 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "calculating toplists",
      "text": "%md\n## Calculating toplists",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 5:12:30 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/markdown",
        "title": false,
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eCalculating toplists\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503044546878_-1809214236",
      "id": "20170818-102226_25200775",
      "dateCreated": "Aug 18, 2017 10:22:26 AM",
      "dateStarted": "Aug 22, 2017 5:12:25 PM",
      "dateFinished": "Aug 22, 2017 5:12:26 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "test_batch \u003d pd.read_csv(\n    \u0027test_batch\u0027,\n    header\u003dNone,\n    names\u003d[\u0027time\u0027,\u0027user\u0027,\u0027item\u0027]\n)\ntrain_test_users \u003d list(set(train_batch.user) \u0026 set(test_batch.user))\npd.Series(train_test_users).to_csv(\u0027train_test_users.csv\u0027,index\u003dFalse)\n\nalpenglow_topks \u003d model.recommend(train_test_users, k\u003d100)",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 6:11:20 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1503045269757_1245530043",
      "id": "20170818-103429_1482871678",
      "dateCreated": "Aug 18, 2017 10:34:29 AM",
      "dateStarted": "Aug 22, 2017 6:11:14 PM",
      "dateFinished": "Aug 22, 2017 6:11:15 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%flink\nval users \u003d senv.readTextFile(\"train_test_users.csv\")\nval usersForToplist \u003d users.map((x:String) \u003d\u003e Rating(x.toInt,0,0,0))\nval modelStream \u003d VectorModelFileParser.parse(senv, model, numFactors \u003d 10)\n\npsTopKGenerator(\n        usersForToplist,\n        model \u003d modelStream)\n    .addSink(new TopKToFileSink(topKOut))\n    .setParallelism(1)\n\nsenv.execute()",
      "user": "anonymous",
      "dateUpdated": "Aug 26, 2017 12:48:53 AM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 94.8,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "users: org.apache.flink.streaming.api.scala.DataStream[String] \u003d org.apache.flink.streaming.api.scala.DataStream@4cf22178\nusersForToplist: org.apache.flink.streaming.api.scala.DataStream[hu.sztaki.ilab.ps.matrix.factorization.Utils.Rating] \u003d org.apache.flink.streaming.api.scala.DataStream@4043b9dd\nmodelStream: hu.sztaki.ilab.ps.utils.DataStreamWithNameableFunctions[Either[(hu.sztaki.ilab.ps.matrix.factorization.Utils.UserId, hu.sztaki.ilab.ps.matrix.factorization.Vector.LengthAndVector),(hu.sztaki.ilab.ps.matrix.factorization.Utils.ItemId, hu.sztaki.ilab.ps.matrix.factorization.Vector.LengthAndVector)]] \u003d hu.sztaki.ilab.ps.utils.DataStreamWithNameableFunctions@161177db\nres42: org.apache.flink.streaming.api.datastream.DataStreamSink[(hu.sztaki.ilab.ps.matrix.factorization.Utils.UserId, List[(Double, hu.sztaki.ilab.ps.matrix.factorization.Utils.ItemId)])] \u003d org.apache.flink.streaming.api.datastream.DataStreamSink@38691924\nres43: org.apache.flink.api.common.JobExecutionResult \u003d org.apache.flink.api.common.JobExecutionResult@7ae158a3\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503045322137_1221583666",
      "id": "20170818-103522_275665771",
      "dateCreated": "Aug 18, 2017 10:35:22 AM",
      "dateStarted": "Aug 26, 2017 12:48:53 AM",
      "dateFinished": "Aug 26, 2017 12:49:32 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ntry:    \n    shutil.rmtree(\u0027sparkPrediction\u0027)\nexcept FileNotFoundError:\n    pass\n\nmodel.save(sc, \"sparkPrediction\")\n\nuser_vectors \u003d pq.read_table(\"sparkPrediction/data/user\").to_pandas()\nuser_vectors.columns \u003d [\u0027user\u0027,\u0027factors\u0027]\nuser_vectors \u003d pd.concat([\n    user_vectors[\u0027user\u0027],\n    user_vectors[\u0027factors\u0027].apply(pd.Series)\n], axis\u003d1)\n\nitem_vectors \u003d pq.read_table(\"sparkPrediction/data/product\").to_pandas()\nitem_vectors.columns \u003d [\u0027item\u0027,\u0027factors\u0027]\nitem_vectors \u003d pd.concat([\n    item_vectors[\u0027item\u0027],\n    item_vectors[\u0027factors\u0027].apply(pd.Series)\n], axis\u003d1)\n\nitem_vectors.set_index(\u0027item\u0027, inplace\u003dTrue)\n\n\ntest_batch \u003d pd.read_csv(\n    \u0027test_batch\u0027,\n    header\u003dNone,\n    names\u003d[\u0027time\u0027,\u0027user\u0027,\u0027item\u0027]\n)\n\nps \u003d None\ntrain_test_users \u003d list(set(train_batch.user) \u0026 set(test_batch.user))\nrelevant_user_vectors \u003d user_vectors[user_vectors.user.isin(set(train_test_users))]\n\nuser_toplists \u003d []\nfor v in relevant_user_vectors.values:\n    user \u003d v[0]\n    user_vec \u003d pd.Series(v[1:])\n    items \u003d item_vectors\\\n        .multiply(user_vec,axis\u003d1)\\\n        .sum(axis\u003d1) \\\n        .nlargest(100)\\\n        .index\n    for item,rank in zip(items, range(1,101)):\n        user_toplists.append((user,item,rank))\n\nspark_topks \u003d pd.DataFrame.from_records(user_toplists, columns\u003d[\u0027user\u0027,\u0027item\u0027,\u0027rank\u0027])",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 5:11:49 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false,
        "lineNumbers": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1503045465374_-1369548579",
      "id": "20170818-103745_516122392",
      "dateCreated": "Aug 18, 2017 10:37:45 AM",
      "dateStarted": "Aug 22, 2017 4:54:42 PM",
      "dateFinished": "Aug 22, 2017 4:55:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "evaluating toplists",
      "text": "flink_topks \u003d pd.read_csv(\u0027topK.out\u0027, header\u003dNone, names\u003d[\u0027user\u0027,\u0027item\u0027,\u0027rank\u0027])\n\ntest_relevant \u003d test_batch[test_batch.user.isin(train_batch.user)]\ntest_relevant[\u0027score\u0027]\u003d1\n\nprint(NdcgScore(test_relevant, alpenglow_topks))\nprint(NdcgScore(test_relevant, flink_topks))\nprint(NdcgScore(test_relevant, spark_topks))",
      "user": "anonymous",
      "dateUpdated": "Aug 22, 2017 6:16:56 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "title": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "Traceback (most recent call last):\n  File \"/tmp/zeppelin_python-1145988153383270072.py\", line 275, in \u003cmodule\u003e\n    exec(code, _zcUserQueryNameSpace)\n  File \"\u003cstdin\u003e\", line 4, in \u003cmodule\u003e\nNameError: name \u0027NdcgScore\u0027 is not defined\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_python-1145988153383270072.py\", line 282, in \u003cmodule\u003e\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_python-1145988153383270072.py\", line 275, in \u003cmodule\u003e\n    exec(code, _zcUserQueryNameSpace)\n  File \"\u003cstdin\u003e\", line 4, in \u003cmodule\u003e\nNameError: name \u0027NdcgScore\u0027 is not defined\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1503046070769_1492675634",
      "id": "20170818-104750_33771494",
      "dateCreated": "Aug 18, 2017 10:47:50 AM",
      "dateStarted": "Aug 22, 2017 6:16:40 PM",
      "dateFinished": "Aug 22, 2017 6:16:41 PM",
      "status": "ERROR",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "",
      "user": "anonymous",
      "dateUpdated": "Aug 21, 2017 1:21:10 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1503047438675_1689641356",
      "id": "20170818-111038_1014955065",
      "dateCreated": "Aug 18, 2017 11:10:38 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Batch comparison",
  "id": "2CTPCW7W5",
  "angularObjects": {
    "2CQ5CHCVK:shared_process": [],
    "2CQA8ANBF:shared_process": [],
    "2CPUWTNP5:shared_process": [],
    "2CS666EJY:shared_process": [],
    "2CQ1SYMWR:shared_process": [],
    "2CRX78HZ4:shared_process": [],
    "2CSE5JPER:shared_process": [],
    "2CPEJRKEY:shared_process": [],
    "2CR9VJ4VU:shared_process": [],
    "2CQ144JX5:shared_process": [],
    "2CNWA3851:shared_process": [],
    "2CRTAP1ZV:shared_process": [],
    "2CQVGSGZX:shared_process": [],
    "2CRQ2EJN1:shared_process": [],
    "2CS38SHJX:shared_process": [],
    "2CNU9Q44Q:shared_process": [],
    "2CSK5B72V:shared_process": [],
    "2CRPWHNGP:shared_process": [],
    "2CS7NTJ4W:shared_process": []
  },
  "config": {},
  "info": {}
}